<div class="container">

  <div class="title-group">
    <div class="title">
      <p2>完了済み配達一覧</p2>
      <p3>| Completed Deliveries</p3>
    </div>
  </div>

  <table class="table table-striped mt-3">
    <thead>
      <tr>
        <th>#</th>
        <th>コース</th>
        <th>配達先</th>
        <th>件数</th>
        <th>個数</th>
        <th>完了時間</th>
      </tr>
    </thead>

    <tbody>
      <% @delivery_stops.each_with_index do |stop, i| %>
        <tr>
          <td><strong><%= i + 1 %></strong></td>
          <td><%= stop.delivery.course.name %></td>
          <td><%= stop.destination.name %></td>
          <td><%= stop.packages_count %></td>
          <td><%= stop.pieces_count %></td>
          <td><%= stop.completed_at&.strftime("%H:%M") %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="summary-container">
    <div class="summary-item">
      <span class="summary-label">合計件数</span>
      <span class="summary-value"><%= @total_packages %>件</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">合計個数</span>
      <span class="summary-value"><%= @total_pieces %>個</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">所要時間</span>
      <span class="summary-value"><%= format_duration(@work_seconds) %></span>
    </div>
    <div class="summary-item">
      <span class="summary-label">走行距離</span>
      <span class="summary-value"><%= @distance_km.present? ? "#{@distance_km}km" : "-" %></span>
    </div>
  </div>

  <div class="nav-button-group mt-4">
    <%= link_to "荷物登録へ戻る",
                new_delivery_delivery_stop_path(@delivery || Delivery.order(id: :desc).first),
                class: "btn btn-primary" %>
  </div>
</div>
