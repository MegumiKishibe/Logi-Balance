<div class="container">
  <input type="hidden" id="daily-course-run-id" value="<%= @daily_course_run.id %>">

  <div class="title-group">
    <div class="title">
      <p2>荷物登録</p2>
      <p3>| Package Registration</p3>
    </div>
  </div>

  <p class="welcome-msg">
    <%= @daily_course_run.delivery_route.name %> コース : <%= current_employee.last_name_ja %>D
  </p>

  <div class="form-card">
    <%= form_with scope: :daily_course_run_stop,
                  url: daily_course_run_daily_course_run_stops_path(@daily_course_run),
                  method: :post,
                  local: true do |form| %>
      <div class="input-grid">
        <div class="input-group">
          <label class="input-label">配達先：</label>
          <div class="select-wrapper">
            <%= form.collection_select :destination_id,
                                       @daily_course_run.delivery_route.destinations,
                                       :id,
                                       :name,
                                       { prompt: "選択してください" },
                                       id: "select-destinations",
                                       class: "form-select",
                                       required: true %>
          </div>
        </div>

        <div class="input-group">
          <label class="input-label">件数：</label>
          <%= form.number_field :packages_count,
                                min: 1,
                                max: 10,
                                required: true,
                                id: "select-packages",
                                class: "form-input",
                                placeholder: "0" %>
        </div>

        <div class="input-group">
          <label class="input-label">個数：</label>
          <%= form.number_field :pieces_count,
                                min: 1,
                                max: 20,
                                required: true,
                                id: "select-pieces",
                                class: "form-input",
                                placeholder: "0" %>
        </div>

        <div class="form-actions-center">
          <button id="button-add" type="button" class="btn btn-secondary btn-wide">追加</button>
        </div>
      </div>
    <% end %>

    <div class="section-divider"></div>

    <div class="title-group small">
      <div class="title">
        <p2 style="font-size: 1.2rem;">配達先一覧</p2>
        <p3>| List of Destinations</p3>
      </div>
    </div>

    <ul id="list">
      <% @daily_course_run_stops.each do |stop| %>
        <li data-id="<%= stop.id %>">
          <span class="stop-info">
            <%= stop.destination.name %>：<%= stop.packages_count %>件／<%= stop.pieces_count %>個
          </span>
          <div class="btn-group-mobile">
            <button class="btn btn-secondary delete-btn" data-turbo="false">削除</button>
            <button class="btn btn-primary done-btn" data-turbo="false">完了</button>
          </div>
        </li>
      <% end %>
    </ul>
  </div>

  <div class="bottom-actions-container">
    <%= form_with model: @daily_course_run,
                  url: finish_daily_course_run_path(@daily_course_run),
                  method: :patch,
                  local: true do |f| %>
      <div class="input-group end-odometer">
        <label class="input-label">終了指針</label>
        <%= f.number_field :odo_end_km,
                           required: true,
                           min: 0,
                           step: 1,
                           class: "form-input",
                           placeholder: "00000" %>
      </div>

      <div class="vertical-button-group">
        <%= f.submit "一覧へ", class: "btn btn-primary btn-wide" %>
        <%= link_to "戻る", new_daily_course_run_path, class: "btn btn-secondary btn-wide" %>
      </div>
    <% end %>
  </div>
</div>
