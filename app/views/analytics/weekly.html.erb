<div class="title-group">
  <div class="title">
    <p2>Analytics</p2>
    <p3>| 週次負荷ポイント推移</p3>
  </div>
</div>

<div class="dashboard-tabs">
  <%= link_to "単日", analytics_path, class: "dash-tab #{action_name == 'index' ? 'active' : ''}" %>
  <%= link_to "週次", weekly_analytics_path, class: "dash-tab #{action_name == 'weekly' ? 'active' : ''}" %>
  <%= link_to "月次", monthly_analytics_path, class: "dash-tab #{action_name == 'monthly' ? 'active' : ''}" %>
</div>

<div class="filter-section">
  <%= form_with url: weekly_analytics_path, method: :get, local: true, class: "field-row" do %>
    <label class="form-label">表示週：</label>
    <div class="select-wrapper">
      <%= select_tag :start_date,
            options_for_select(@weeks.map { |d| ["#{d.strftime("%m/%d")} 〜 #{(d+6).strftime("%m/%d")}", d] }, @start_date),
            onchange: "this.form.submit()",
            class: "form-select" %>
    </div>
  <% end %>
</div>

<div class="analytics-chart-panel">
  <%= line_chart @weekly_scores, 
        colors: ["#6abf69"], 
        curve: true,
        library: { 
          backgroundColor: "transparent",
          scales: {
            y: { grid: { color: "rgba(0,0,0,0.05)" } },
            x: { grid: { display: false } }
          }
        } %>
</div>